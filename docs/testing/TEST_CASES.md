# AI 面试系统 - 后端接口测试用例文档

## 目录
- [1. 认证模块 (Auth Module)](#1-认证模块-auth-module)
- [2. 用户模块 (Users Module)](#2-用户模块-users-module)
- [3. 题目模块 (Questions Module)](#3-题目模块-questions-module)
- [4. 面试模块 (Interviews Module)](#4-面试模块-interviews-module)
- [5. 提交模块 (Submissions Module)](#5-提交模块-submissions-module)
- [6. 权限与角色测试](#6-权限与角色测试)
- [7. 数据验证测试](#7-数据验证测试)
- [8. 性能与压力测试](#8-性能与压力测试)

---

## 1. 认证模块 (Auth Module)

### 1.1 用户注册 (POST /auth/register)

#### TC-AUTH-001: 成功注册候选人账户
- **前置条件**: 无
- **测试数据**:
  ```json
  {
    "username": "candidate_test",
    "email": "candidate@test.com",
    "password": "Test123456!",
    "roleId": 3
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 201
  - 返回创建的用户信息（不包含密码）
  - 数据库中创建新用户记录

#### TC-AUTH-002: 成功注册面试官账户
- **前置条件**: 无
- **测试数据**:
  ```json
  {
    "username": "interviewer_test",
    "email": "interviewer@test.com",
    "password": "Test123456!",
    "roleId": 2
  }
  ```
- **期望结果**: HTTP 状态码: 201

#### TC-AUTH-003: 成功注册管理员账户
- **前置条件**: 无
- **测试数据**:
  ```json
  {
    "username": "admin_test",
    "email": "admin@test.com",
    "password": "Test123456!",
    "roleId": 1
  }
  ```
- **期望结果**: HTTP 状态码: 201

#### TC-AUTH-004: 用户名已存在
- **前置条件**: 系统中已存在用户名为 "existing_user"
- **测试数据**:
  ```json
  {
    "username": "existing_user",
    "email": "new@test.com",
    "password": "Test123456!",
    "roleId": 3
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400 或 409
  - 错误消息: "用户名已存在"

#### TC-AUTH-005: 邮箱已存在
- **前置条件**: 系统中已存在邮箱 "existing@test.com"
- **测试数据**:
  ```json
  {
    "username": "new_user",
    "email": "existing@test.com",
    "password": "Test123456!",
    "roleId": 3
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400 或 409
  - 错误消息: "邮箱已存在"

#### TC-AUTH-006: 无效的邮箱格式
- **测试数据**:
  ```json
  {
    "username": "test_user",
    "email": "invalid-email",
    "password": "Test123456!",
    "roleId": 3
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "邮箱格式不正确"

#### TC-AUTH-007: 密码过短
- **测试数据**:
  ```json
  {
    "username": "test_user",
    "email": "test@test.com",
    "password": "123",
    "roleId": 3
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "密码长度不足"

#### TC-AUTH-008: 缺少必填字段
- **测试数据**:
  ```json
  {
    "username": "test_user"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "缺少必填字段"

#### TC-AUTH-009: 无效的角色ID
- **测试数据**:
  ```json
  {
    "username": "test_user",
    "email": "test@test.com",
    "password": "Test123456!",
    "roleId": 999
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "无效的角色ID"

### 1.2 用户登录 (POST /auth/login)

#### TC-AUTH-010: 使用用户名成功登录
- **前置条件**: 系统中存在用户
- **测试数据**:
  ```json
  {
    "username": "candidate_test",
    "password": "Test123456!"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回包含 JWT token 和用户信息
  - Token 格式正确且可解析

#### TC-AUTH-011: 使用邮箱成功登录
- **前置条件**: 系统中存在用户
- **测试数据**:
  ```json
  {
    "email": "candidate@test.com",
    "password": "Test123456!"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回 JWT token 和用户信息

#### TC-AUTH-012: 错误的密码
- **测试数据**:
  ```json
  {
    "username": "candidate_test",
    "password": "WrongPassword!"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 401
  - 错误消息: "用户名或密码错误"

#### TC-AUTH-013: 不存在的用户
- **测试数据**:
  ```json
  {
    "username": "nonexistent_user",
    "password": "Test123456!"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 401
  - 错误消息: "用户名或密码错误"

#### TC-AUTH-014: 空用户名和密码
- **测试数据**:
  ```json
  {
    "username": "",
    "password": ""
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "用户名和密码不能为空"

#### TC-AUTH-015: 缺少登录凭证
- **测试数据**:
  ```json
  {}
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "缺少登录凭证"

### 1.3 获取当前用户信息 (GET /auth/profile)

#### TC-AUTH-016: 使用有效token获取用户信息
- **前置条件**: 用户已登录，持有有效token
- **请求头**: `Authorization: Bearer <valid_token>`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回当前用户的详细信息（不包含密码）

#### TC-AUTH-017: 未提供token
- **请求头**: 无 Authorization 头
- **期望结果**: 
  - HTTP 状态码: 401
  - 错误消息: "未授权"

#### TC-AUTH-018: 使用过期token
- **前置条件**: 持有已过期的token
- **请求头**: `Authorization: Bearer <expired_token>`
- **期望结果**: 
  - HTTP 状态码: 401
  - 错误消息: "Token已过期"

#### TC-AUTH-019: 使用无效token格式
- **请求头**: `Authorization: Bearer invalid_token_format`
- **期望结果**: 
  - HTTP 状态码: 401
  - 错误消息: "无效的token"

#### TC-AUTH-020: 使用被篡改的token
- **请求头**: `Authorization: Bearer <tampered_token>`
- **期望结果**: 
  - HTTP 状态码: 401
  - 错误消息: "无效的token"

---

## 2. 用户模块 (Users Module)

### 2.1 创建用户 (POST /users) - 仅管理员

#### TC-USER-001: 管理员成功创建候选人用户
- **前置条件**: 以管理员身份登录
- **请求头**: `Authorization: Bearer <admin_token>`
- **测试数据**:
  ```json
  {
    "username": "new_candidate",
    "email": "newcandidate@test.com",
    "password": "Test123456!",
    "roleId": 3
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 201
  - 返回创建的用户信息

#### TC-USER-002: 管理员创建面试官用户
- **前置条件**: 以管理员身份登录
- **期望结果**: HTTP 状态码: 201

#### TC-USER-003: 面试官尝试创建用户（权限不足）
- **前置条件**: 以面试官身份登录
- **请求头**: `Authorization: Bearer <interviewer_token>`
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-USER-004: 候选人尝试创建用户（权限不足）
- **前置条件**: 以候选人身份登录
- **请求头**: `Authorization: Bearer <candidate_token>`
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-USER-005: 未登录尝试创建用户
- **请求头**: 无 Authorization 头
- **期望结果**: 
  - HTTP 状态码: 401
  - 错误消息: "未授权"

### 2.2 获取所有用户 (GET /users) - 管理员/面试官

#### TC-USER-006: 管理员获取所有用户列表
- **前置条件**: 以管理员身份登录
- **请求头**: `Authorization: Bearer <admin_token>`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回所有用户列表（不包含密码）
  - 包含分页信息（如果有）

#### TC-USER-007: 面试官获取所有用户列表
- **前置条件**: 以面试官身份登录
- **请求头**: `Authorization: Bearer <interviewer_token>`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回用户列表

#### TC-USER-008: 候选人尝试获取用户列表（权限不足）
- **前置条件**: 以候选人身份登录
- **请求头**: `Authorization: Bearer <candidate_token>`
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-USER-009: 空数据库中获取用户列表
- **前置条件**: 数据库中无用户数据
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回空数组

### 2.3 获取所有角色 (GET /users/roles)

#### TC-USER-010: 获取所有角色列表
- **前置条件**: 用户已登录（任意角色）
- **请求头**: `Authorization: Bearer <valid_token>`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回所有角色列表
  - 包含: admin, interviewer, candidate

#### TC-USER-011: 未登录获取角色列表
- **请求头**: 无 Authorization 头
- **期望结果**: 
  - HTTP 状态码: 401
  - 错误消息: "未授权"

### 2.4 获取用户详情 (GET /users/:id)

#### TC-USER-012: 获取存在的用户详情
- **前置条件**: 用户已登录
- **请求头**: `Authorization: Bearer <valid_token>`
- **URL**: `/users/1`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回用户详细信息（不包含密码）

#### TC-USER-013: 获取不存在的用户
- **URL**: `/users/99999`
- **期望结果**: 
  - HTTP 状态码: 404
  - 错误消息: "用户不存在"

#### TC-USER-014: 无效的用户ID格式
- **URL**: `/users/invalid_id`
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "无效的用户ID"

#### TC-USER-015: 用户查看自己的信息
- **前置条件**: 候选人已登录，用户ID为5
- **URL**: `/users/5`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回完整的用户信息

#### TC-USER-016: 候选人查看其他用户信息
- **前置条件**: 候选人已登录，尝试查看其他用户
- **URL**: `/users/1`
- **期望结果**: 根据业务规则，可能返回200（有限信息）或403

### 2.5 更新用户信息 (PATCH /users/:id)

#### TC-USER-017: 用户更新自己的信息
- **前置条件**: 用户已登录，用户ID为5
- **URL**: `/users/5`
- **测试数据**:
  ```json
  {
    "email": "updated@test.com"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回更新后的用户信息

#### TC-USER-018: 管理员更新其他用户信息
- **前置条件**: 以管理员身份登录
- **URL**: `/users/5`
- **测试数据**:
  ```json
  {
    "roleId": 2
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 200
  - 用户角色成功更新

#### TC-USER-019: 候选人尝试更新其他用户信息
- **前置条件**: 候选人已登录，用户ID为5
- **URL**: `/users/3`
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-USER-020: 更新为重复的邮箱
- **前置条件**: 系统中已存在邮箱 "existing@test.com"
- **测试数据**:
  ```json
  {
    "email": "existing@test.com"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400 或 409
  - 错误消息: "邮箱已被使用"

#### TC-USER-021: 更新为无效的邮箱格式
- **测试数据**:
  ```json
  {
    "email": "invalid-email"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "邮箱格式不正确"

#### TC-USER-022: 更新不存在的用户
- **URL**: `/users/99999`
- **期望结果**: 
  - HTTP 状态码: 404
  - 错误消息: "用户不存在"

### 2.6 删除用户 (DELETE /users/:id) - 仅管理员

#### TC-USER-023: 管理员成功删除用户
- **前置条件**: 以管理员身份登录
- **URL**: `/users/10`
- **期望结果**: 
  - HTTP 状态码: 200 或 204
  - 用户从数据库中删除

#### TC-USER-024: 面试官尝试删除用户（权限不足）
- **前置条件**: 以面试官身份登录
- **URL**: `/users/10`
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-USER-025: 候选人尝试删除用户（权限不足）
- **前置条件**: 以候选人身份登录
- **URL**: `/users/10`
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-USER-026: 删除不存在的用户
- **前置条件**: 以管理员身份登录
- **URL**: `/users/99999`
- **期望结果**: 
  - HTTP 状态码: 404
  - 错误消息: "用户不存在"

#### TC-USER-027: 管理员尝试删除自己
- **前置条件**: 以管理员身份登录，用户ID为1
- **URL**: `/users/1`
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "不能删除自己的账户"

#### TC-USER-028: 删除有关联数据的用户（级联删除测试）
- **前置条件**: 用户有提交记录、面试场次等关联数据
- **期望结果**: 根据业务规则处理关联数据

---

## 3. 题目模块 (Questions Module)

### 3.1 创建题目 (POST /questions) - 管理员/面试官

#### TC-QUES-001: 管理员创建编程题
- **前置条件**: 以管理员身份登录
- **测试数据**:
  ```json
  {
    "type": "programming",
    "title": "两数之和",
    "description": "给定一个整数数组和一个目标值，找出数组中和为目标值的两个数...",
    "difficulty": "easy",
    "tags": ["数组", "哈希表"],
    "languageOptions": ["python", "javascript", "java"],
    "testCases": [
      {
        "input": "[2,7,11,15], 9",
        "output": "[0,1]",
        "isHidden": false
      }
    ],
    "starterCode": {
      "python": "def twoSum(nums, target):\n    pass",
      "javascript": "function twoSum(nums, target) {\n    \n}"
    },
    "timeLimit": 1000,
    "memoryLimit": 256
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 201
  - 返回创建的题目信息

#### TC-QUES-002: 面试官创建问答题
- **前置条件**: 以面试官身份登录
- **测试数据**:
  ```json
  {
    "type": "qa",
    "title": "介绍一下你做过的最有挑战的项目",
    "description": "请详细描述项目背景、你的角色、遇到的挑战和解决方案",
    "difficulty": "medium",
    "tags": ["项目经验", "问题解决"],
    "referenceAnswer": "应包括：项目背景、技术栈、个人贡献、问题与解决方案...",
    "scoringCriteria": {
      "clarity": 25,
      "depth": 25,
      "technical": 25,
      "communication": 25
    }
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 201
  - 返回创建的问答题

#### TC-QUES-003: 候选人尝试创建题目（权限不足）
- **前置条件**: 以候选人身份登录
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-QUES-004: 创建题目时缺少必填字段
- **测试数据**:
  ```json
  {
    "type": "programming",
    "title": "测试题目"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "缺少必填字段"

#### TC-QUES-005: 无效的题目类型
- **测试数据**:
  ```json
  {
    "type": "invalid_type",
    "title": "测试题目",
    "description": "描述"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "无效的题目类型"

#### TC-QUES-006: 无效的难度等级
- **测试数据**:
  ```json
  {
    "type": "programming",
    "title": "测试题目",
    "description": "描述",
    "difficulty": "invalid_difficulty"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "无效的难度等级"

#### TC-QUES-007: 编程题缺少测试用例
- **测试数据**: 编程题但未提供 testCases
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "编程题必须包含测试用例"

#### TC-QUES-008: 题目标题过长
- **测试数据**: title 超过字符限制
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "标题长度超出限制"

### 3.2 获取所有题目 (GET /questions)

#### TC-QUES-009: 获取所有题目列表
- **前置条件**: 用户已登录
- **请求头**: `Authorization: Bearer <valid_token>`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回所有题目列表

#### TC-QUES-010: 按类型筛选题目（编程题）
- **URL**: `/questions?type=programming`
- **期望结果**: 
  - HTTP 状态码: 200
  - 只返回编程题

#### TC-QUES-011: 按类型筛选题目（问答题）
- **URL**: `/questions?type=qa`
- **期望结果**: 
  - HTTP 状态码: 200
  - 只返回问答题

#### TC-QUES-012: 按难度筛选题目（简单）
- **URL**: `/questions?difficulty=easy`
- **期望结果**: 
  - HTTP 状态码: 200
  - 只返回简单难度的题目

#### TC-QUES-013: 按难度筛选题目（中等）
- **URL**: `/questions?difficulty=medium`
- **期望结果**: 
  - HTTP 状态码: 200
  - 只返回中等难度的题目

#### TC-QUES-014: 按难度筛选题目（困难）
- **URL**: `/questions?difficulty=hard`
- **期望结果**: 
  - HTTP 状态码: 200
  - 只返回困难题目

#### TC-QUES-015: 同时按类型和难度筛选
- **URL**: `/questions?type=programming&difficulty=easy`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回简单的编程题

#### TC-QUES-016: 使用无效的筛选参数
- **URL**: `/questions?type=invalid`
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "无效的筛选参数"

#### TC-QUES-017: 空数据库中获取题目列表
- **前置条件**: 数据库中无题目数据
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回空数组

#### TC-QUES-018: 未登录获取题目列表
- **请求头**: 无 Authorization 头
- **期望结果**: 
  - HTTP 状态码: 401
  - 错误消息: "未授权"

### 3.3 获取题目详情 (GET /questions/:id)

#### TC-QUES-019: 获取存在的编程题详情
- **前置条件**: 用户已登录
- **URL**: `/questions/1`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回完整的题目信息（包括测试用例、起始代码等）

#### TC-QUES-020: 获取存在的问答题详情
- **URL**: `/questions/2`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回问答题信息（候选人不应看到参考答案）

#### TC-QUES-021: 面试官/管理员查看题目详情
- **前置条件**: 以面试官或管理员身份登录
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回完整信息（包括参考答案、评分标准）

#### TC-QUES-022: 获取不存在的题目
- **URL**: `/questions/99999`
- **期望结果**: 
  - HTTP 状态码: 404
  - 错误消息: "题目不存在"

#### TC-QUES-023: 无效的题目ID格式
- **URL**: `/questions/invalid_id`
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "无效的题目ID"

### 3.4 更新题目 (PATCH /questions/:id) - 管理员/面试官

#### TC-QUES-024: 管理员更新题目信息
- **前置条件**: 以管理员身份登录
- **URL**: `/questions/1`
- **测试数据**:
  ```json
  {
    "title": "两数之和（更新版）",
    "difficulty": "medium"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回更新后的题目信息

#### TC-QUES-025: 面试官更新自己创建的题目
- **前置条件**: 以面试官身份登录，题目由该面试官创建
- **期望结果**: 
  - HTTP 状态码: 200
  - 题目信息更新成功

#### TC-QUES-026: 面试官尝试更新其他人创建的题目
- **前置条件**: 以面试官身份登录，题目由其他人创建
- **期望结果**: 根据业务规则，可能返回403或200

#### TC-QUES-027: 候选人尝试更新题目（权限不足）
- **前置条件**: 以候选人身份登录
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-QUES-028: 更新为无效的数据
- **测试数据**:
  ```json
  {
    "difficulty": "invalid_level"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "无效的难度等级"

#### TC-QUES-029: 更新不存在的题目
- **URL**: `/questions/99999`
- **期望结果**: 
  - HTTP 状态码: 404
  - 错误消息: "题目不存在"

#### TC-QUES-030: 更新题目的测试用例
- **前置条件**: 以管理员身份登录
- **测试数据**:
  ```json
  {
    "testCases": [
      {
        "input": "[1,2,3], 5",
        "output": "[1,2]",
        "isHidden": false
      }
    ]
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 200
  - 测试用例更新成功

### 3.5 删除题目 (DELETE /questions/:id) - 仅管理员

#### TC-QUES-031: 管理员成功删除题目
- **前置条件**: 以管理员身份登录
- **URL**: `/questions/10`
- **期望结果**: 
  - HTTP 状态码: 200 或 204
  - 题目从数据库中删除

#### TC-QUES-032: 面试官尝试删除题目（权限不足）
- **前置条件**: 以面试官身份登录
- **URL**: `/questions/10`
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-QUES-033: 候选人尝试删除题目（权限不足）
- **前置条件**: 以候选人身份登录
- **URL**: `/questions/10`
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-QUES-034: 删除不存在的题目
- **前置条件**: 以管理员身份登录
- **URL**: `/questions/99999`
- **期望结果**: 
  - HTTP 状态码: 404
  - 错误消息: "题目不存在"

#### TC-QUES-035: 删除已被面试使用的题目
- **前置条件**: 题目已被某些面试模板使用
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "题目正在被使用，无法删除"
  - 或者根据业务规则进行软删除

---

## 4. 面试模块 (Interviews Module)

### 4.1 创建面试场次 (POST /interviews/sessions)

#### TC-INTV-001: 成功创建面试场次
- **前置条件**: 用户已登录（任意角色）
- **测试数据**:
  ```json
  {
    "name": "前端工程师面试 - 张三",
    "candidateId": 5,
    "templateId": 1,
    "scheduledStartTime": "2025-10-25T10:00:00Z",
    "scheduledEndTime": "2025-10-25T12:00:00Z"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 201
  - 返回创建的面试场次信息
  - 状态为 "pending"

#### TC-INTV-002: 管理员创建面试场次
- **前置条件**: 以管理员身份登录
- **期望结果**: HTTP 状态码: 201

#### TC-INTV-003: 面试官创建面试场次
- **前置条件**: 以面试官身份登录
- **期望结果**: HTTP 状态码: 201

#### TC-INTV-004: 候选人为自己创建面试场次
- **前置条件**: 以候选人身份登录，创建自己的面试
- **期望结果**: 根据业务规则，可能返回201或403

#### TC-INTV-005: 缺少必填字段
- **测试数据**:
  ```json
  {
    "name": "测试面试"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "缺少必填字段"

#### TC-INTV-006: 无效的候选人ID
- **测试数据**:
  ```json
  {
    "name": "测试面试",
    "candidateId": 99999,
    "templateId": 1
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400 或 404
  - 错误消息: "候选人不存在"

#### TC-INTV-007: 无效的模板ID
- **测试数据**:
  ```json
  {
    "name": "测试面试",
    "candidateId": 5,
    "templateId": 99999
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400 或 404
  - 错误消息: "模板不存在"

#### TC-INTV-008: 结束时间早于开始时间
- **测试数据**:
  ```json
  {
    "name": "测试面试",
    "candidateId": 5,
    "templateId": 1,
    "scheduledStartTime": "2025-10-25T12:00:00Z",
    "scheduledEndTime": "2025-10-25T10:00:00Z"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "结束时间必须晚于开始时间"

#### TC-INTV-009: 候选人在同一时间段已有面试
- **前置条件**: 候选人在该时间段已有其他面试
- **期望结果**: 
  - HTTP 状态码: 400 或 409
  - 错误消息: "该时间段已有面试安排"

### 4.2 获取面试场次列表 (GET /interviews/sessions)

#### TC-INTV-010: 候选人获取自己的面试列表
- **前置条件**: 以候选人身份登录
- **请求头**: `Authorization: Bearer <candidate_token>`
- **期望结果**: 
  - HTTP 状态码: 200
  - 只返回该候选人的面试场次

#### TC-INTV-011: 面试官获取所有面试列表
- **前置条件**: 以面试官身份登录
- **请求头**: `Authorization: Bearer <interviewer_token>`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回所有面试场次或面试官负责的场次

#### TC-INTV-012: 管理员获取所有面试列表
- **前置条件**: 以管理员身份登录
- **请求头**: `Authorization: Bearer <admin_token>`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回所有面试场次

#### TC-INTV-013: 空数据库中获取面试列表
- **前置条件**: 数据库中无面试场次
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回空数组

#### TC-INTV-014: 未登录获取面试列表
- **请求头**: 无 Authorization 头
- **期望结果**: 
  - HTTP 状态码: 401
  - 错误消息: "未授权"

### 4.3 获取面试场次详情 (GET /interviews/sessions/:id)

#### TC-INTV-015: 候选人获取自己的面试详情
- **前置条件**: 候选人已登录，面试属于该候选人
- **URL**: `/interviews/sessions/1`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回面试详细信息（包括题目列表）

#### TC-INTV-016: 面试官获取面试详情
- **前置条件**: 以面试官身份登录
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回完整的面试信息

#### TC-INTV-017: 候选人尝试获取其他人的面试详情
- **前置条件**: 候选人已登录，面试不属于该候选人
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-INTV-018: 获取不存在的面试场次
- **URL**: `/interviews/sessions/99999`
- **期望结果**: 
  - HTTP 状态码: 404
  - 错误消息: "面试场次不存在"

#### TC-INTV-019: 无效的场次ID格式
- **URL**: `/interviews/sessions/invalid_id`
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "无效的场次ID"

### 4.4 开始面试 (PATCH /interviews/sessions/:id/start)

#### TC-INTV-020: 候选人成功开始面试
- **前置条件**: 候选人已登录，面试状态为 "pending"
- **URL**: `/interviews/sessions/1/start`
- **期望结果**: 
  - HTTP 状态码: 200
  - 面试状态更新为 "in_progress"
  - 返回开始时间

#### TC-INTV-021: 面试官代替候选人开始面试
- **前置条件**: 以面试官身份登录
- **期望结果**: 
  - HTTP 状态码: 200
  - 面试状态更新为 "in_progress"

#### TC-INTV-022: 候选人尝试开始其他人的面试
- **前置条件**: 候选人已登录，面试不属于该候选人
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-INTV-023: 重复开始已进行中的面试
- **前置条件**: 面试状态已是 "in_progress"
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "面试已经开始"

#### TC-INTV-024: 开始已完成的面试
- **前置条件**: 面试状态为 "completed"
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "面试已结束，无法重新开始"

#### TC-INTV-025: 开始不存在的面试
- **URL**: `/interviews/sessions/99999/start`
- **期望结果**: 
  - HTTP 状态码: 404
  - 错误消息: "面试场次不存在"

### 4.5 完成面试 (PATCH /interviews/sessions/:id/complete)

#### TC-INTV-026: 候选人成功完成面试
- **前置条件**: 候选人已登录，面试状态为 "in_progress"
- **URL**: `/interviews/sessions/1/complete`
- **期望结果**: 
  - HTTP 状态码: 200
  - 面试状态更新为 "completed"
  - 返回完成时间
  - 触发AI评分流程

#### TC-INTV-027: 面试官代替候选人完成面试
- **前置条件**: 以面试官身份登录
- **期望结果**: 
  - HTTP 状态码: 200
  - 面试状态更新为 "completed"

#### TC-INTV-028: 完成未开始的面试
- **前置条件**: 面试状态为 "pending"
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "面试尚未开始"

#### TC-INTV-029: 重复完成已结束的面试
- **前置条件**: 面试状态已是 "completed"
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "面试已经完成"

#### TC-INTV-030: 候选人尝试完成其他人的面试
- **前置条件**: 候选人已登录，面试不属于该候选人
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

### 4.6 创建面试模板 (POST /interviews/templates) - 管理员/面试官

#### TC-INTV-031: 管理员创建面试模板
- **前置条件**: 以管理员身份登录
- **测试数据**:
  ```json
  {
    "name": "前端工程师标准面试",
    "description": "包含算法题、前端框架题和系统设计题",
    "questionIds": [1, 3, 5, 7],
    "timeLimit": 120,
    "passingScore": 60
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 201
  - 返回创建的模板信息

#### TC-INTV-032: 面试官创建面试模板
- **前置条件**: 以面试官身份登录
- **期望结果**: 
  - HTTP 状态码: 201
  - 模板创建成功

#### TC-INTV-033: 候选人尝试创建模板（权限不足）
- **前置条件**: 以候选人身份登录
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-INTV-034: 缺少必填字段
- **测试数据**:
  ```json
  {
    "name": "测试模板"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "缺少必填字段"

#### TC-INTV-035: 题目ID列表为空
- **测试数据**:
  ```json
  {
    "name": "测试模板",
    "questionIds": [],
    "timeLimit": 60
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "至少需要选择一道题目"

#### TC-INTV-036: 包含不存在的题目ID
- **测试数据**:
  ```json
  {
    "name": "测试模板",
    "questionIds": [1, 99999],
    "timeLimit": 60
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400 或 404
  - 错误消息: "部分题目不存在"

#### TC-INTV-037: 无效的时间限制
- **测试数据**:
  ```json
  {
    "name": "测试模板",
    "questionIds": [1, 2],
    "timeLimit": -10
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "时间限制必须为正数"

### 4.7 获取所有面试模板 (GET /interviews/templates)

#### TC-INTV-038: 获取所有面试模板列表
- **前置条件**: 用户已登录
- **请求头**: `Authorization: Bearer <valid_token>`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回所有模板列表

#### TC-INTV-039: 空数据库中获取模板列表
- **前置条件**: 数据库中无模板数据
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回空数组

#### TC-INTV-040: 未登录获取模板列表
- **请求头**: 无 Authorization 头
- **期望结果**: 
  - HTTP 状态码: 401
  - 错误消息: "未授权"

### 4.8 获取模板详情 (GET /interviews/templates/:id)

#### TC-INTV-041: 获取存在的模板详情
- **前置条件**: 用户已登录
- **URL**: `/interviews/templates/1`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回模板详细信息（包括关联的题目列表）

#### TC-INTV-042: 获取不存在的模板
- **URL**: `/interviews/templates/99999`
- **期望结果**: 
  - HTTP 状态码: 404
  - 错误消息: "模板不存在"

#### TC-INTV-043: 无效的模板ID格式
- **URL**: `/interviews/templates/invalid_id`
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "无效的模板ID"

### 4.9 删除模板 (DELETE /interviews/templates/:id) - 仅管理员

#### TC-INTV-044: 管理员成功删除模板
- **前置条件**: 以管理员身份登录
- **URL**: `/interviews/templates/5`
- **期望结果**: 
  - HTTP 状态码: 200 或 204
  - 模板从数据库中删除

#### TC-INTV-045: 面试官尝试删除模板（权限不足）
- **前置条件**: 以面试官身份登录
- **URL**: `/interviews/templates/5`
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-INTV-046: 候选人尝试删除模板（权限不足）
- **前置条件**: 以候选人身份登录
- **URL**: `/interviews/templates/5`
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-INTV-047: 删除不存在的模板
- **前置条件**: 以管理员身份登录
- **URL**: `/interviews/templates/99999`
- **期望结果**: 
  - HTTP 状态码: 404
  - 错误消息: "模板不存在"

#### TC-INTV-048: 删除正在使用的模板
- **前置条件**: 模板已被某些面试场次使用
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "模板正在被使用，无法删除"
  - 或者根据业务规则处理

---

## 5. 提交模块 (Submissions Module)

### 5.1 提交答案 (POST /submissions)

#### TC-SUBM-001: 候选人成功提交编程题答案
- **前置条件**: 候选人已登录，面试进行中
- **测试数据**:
  ```json
  {
    "sessionId": 1,
    "questionId": 1,
    "type": "programming",
    "language": "python",
    "code": "def twoSum(nums, target):\n    map = {}\n    for i, num in enumerate(nums):\n        if target - num in map:\n            return [map[target - num], i]\n        map[num] = i"
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 201
  - 返回提交记录ID
  - 触发代码执行和测试
  - 返回测试结果

#### TC-SUBM-002: 候选人提交问答题答案
- **前置条件**: 候选人已登录，面试进行中
- **测试数据**:
  ```json
  {
    "sessionId": 1,
    "questionId": 2,
    "type": "qa",
    "answer": "我最有挑战的项目是开发一个实时数据分析平台..."
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 201
  - 返回提交记录ID
  - 触发AI评分

#### TC-SUBM-003: 提交到未开始的面试
- **前置条件**: 面试状态为 "pending"
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "面试尚未开始"

#### TC-SUBM-004: 提交到已结束的面试
- **前置条件**: 面试状态为 "completed"
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "面试已结束，无法提交"

#### TC-SUBM-005: 候选人提交其他人面试的答案
- **前置条件**: 候选人已登录，sessionId 不属于该候选人
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-SUBM-006: 缺少必填字段
- **测试数据**:
  ```json
  {
    "sessionId": 1,
    "questionId": 1
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "缺少必填字段"

#### TC-SUBM-007: 无效的面试场次ID
- **测试数据**:
  ```json
  {
    "sessionId": 99999,
    "questionId": 1,
    "type": "programming",
    "code": "..."
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400 或 404
  - 错误消息: "面试场次不存在"

#### TC-SUBM-008: 无效的题目ID
- **测试数据**:
  ```json
  {
    "sessionId": 1,
    "questionId": 99999,
    "type": "programming",
    "code": "..."
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400 或 404
  - 错误消息: "题目不存在"

#### TC-SUBM-009: 题目不在面试模板中
- **前置条件**: 提交的题目不在面试场次的模板中
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "该题目不在面试范围内"

#### TC-SUBM-010: 编程题代码为空
- **测试数据**:
  ```json
  {
    "sessionId": 1,
    "questionId": 1,
    "type": "programming",
    "code": ""
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "代码不能为空"

#### TC-SUBM-011: 问答题答案为空
- **测试数据**:
  ```json
  {
    "sessionId": 1,
    "questionId": 2,
    "type": "qa",
    "answer": ""
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "答案不能为空"

#### TC-SUBM-012: 重复提交同一题目
- **前置条件**: 该候选人已提交过该题目
- **期望结果**: 
  - HTTP 状态码: 201（允许重复提交，作为新版本）
  - 或 HTTP 状态码: 400（不允许重复提交）
  - 根据业务规则

#### TC-SUBM-013: 提交包含恶意代码的答案
- **测试数据**: 包含系统调用、文件操作等危险代码
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "代码包含不安全操作"
  - 或者在沙箱中安全执行并捕获异常

#### TC-SUBM-014: 代码执行超时
- **前置条件**: 提交的代码执行时间超过限制
- **期望结果**: 
  - HTTP 状态码: 201
  - 返回提交记录
  - 测试结果显示 "超时"

#### TC-SUBM-015: 代码执行出错
- **前置条件**: 提交的代码有语法错误或运行时错误
- **期望结果**: 
  - HTTP 状态码: 201
  - 返回提交记录
  - 测试结果显示错误信息

#### TC-SUBM-016: 代码通过部分测试用例
- **前置条件**: 提交的代码通过部分但非全部测试用例
- **期望结果**: 
  - HTTP 状态码: 201
  - 返回详细的测试结果（通过数/总数）

#### TC-SUBM-017: 代码通过所有测试用例
- **前置条件**: 提交的代码通过所有测试用例
- **期望结果**: 
  - HTTP 状态码: 201
  - 返回满分测试结果

#### TC-SUBM-018: 提交使用不支持的编程语言
- **测试数据**:
  ```json
  {
    "sessionId": 1,
    "questionId": 1,
    "type": "programming",
    "language": "ruby",
    "code": "..."
  }
  ```
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "不支持的编程语言"

### 5.2 获取提交列表 (GET /submissions)

#### TC-SUBM-019: 候选人获取自己的提交列表
- **前置条件**: 以候选人身份登录
- **请求头**: `Authorization: Bearer <candidate_token>`
- **期望结果**: 
  - HTTP 状态码: 200
  - 只返回该候选人的提交记录

#### TC-SUBM-020: 面试官获取所有提交列表
- **前置条件**: 以面试官身份登录
- **请求头**: `Authorization: Bearer <interviewer_token>`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回所有提交记录

#### TC-SUBM-021: 管理员获取所有提交列表
- **前置条件**: 以管理员身份登录
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回所有提交记录

#### TC-SUBM-022: 按面试场次筛选提交
- **URL**: `/submissions?sessionId=1`
- **期望结果**: 
  - HTTP 状态码: 200
  - 只返回该面试场次的提交记录

#### TC-SUBM-023: 按用户ID筛选提交
- **URL**: `/submissions?userId=5`
- **期望结果**: 
  - HTTP 状态码: 200
  - 只返回该用户的提交记录

#### TC-SUBM-024: 同时按场次和用户筛选
- **URL**: `/submissions?sessionId=1&userId=5`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回符合两个条件的提交记录

#### TC-SUBM-025: 候选人尝试查看其他人的提交
- **前置条件**: 以候选人身份登录
- **URL**: `/submissions?userId=3`
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"
  - 或返回空数组（根据业务规则）

#### TC-SUBM-026: 空数据库中获取提交列表
- **前置条件**: 数据库中无提交记录
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回空数组

#### TC-SUBM-027: 未登录获取提交列表
- **请求头**: 无 Authorization 头
- **期望结果**: 
  - HTTP 状态码: 401
  - 错误消息: "未授权"

### 5.3 获取提交详情 (GET /submissions/:id)

#### TC-SUBM-028: 候选人获取自己的提交详情
- **前置条件**: 候选人已登录，提交属于该候选人
- **URL**: `/submissions/1`
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回提交的详细信息（代码、测试结果、评分等）

#### TC-SUBM-029: 面试官获取提交详情
- **前置条件**: 以面试官身份登录
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回完整的提交信息（包括AI评分建议）

#### TC-SUBM-030: 管理员获取提交详情
- **前置条件**: 以管理员身份登录
- **期望结果**: 
  - HTTP 状态码: 200
  - 返回完整的提交信息

#### TC-SUBM-031: 候选人尝试获取其他人的提交详情
- **前置条件**: 候选人已登录，提交不属于该候选人
- **期望结果**: 
  - HTTP 状态码: 403
  - 错误消息: "权限不足"

#### TC-SUBM-032: 获取不存在的提交
- **URL**: `/submissions/99999`
- **期望结果**: 
  - HTTP 状态码: 404
  - 错误消息: "提交记录不存在"

#### TC-SUBM-033: 无效的提交ID格式
- **URL**: `/submissions/invalid_id`
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "无效的提交ID"

---

## 6. 权限与角色测试

### 6.1 角色权限验证

#### TC-PERM-001: 候选人角色权限测试
- **测试步骤**:
  1. 以候选人身份登录
  2. 尝试访问各个需要不同权限的端点
- **期望结果**:
  - 可以访问: 自己的面试、自己的提交、题目列表、提交答案
  - 不可访问: 创建题目、创建模板、查看其他用户、删除操作

#### TC-PERM-002: 面试官角色权限测试
- **测试步骤**:
  1. 以面试官身份登录
  2. 尝试访问各个端点
- **期望结果**:
  - 可以访问: 创建题目、创建模板、查看所有面试、查看所有提交、创建用户（只读）
  - 不可访问: 删除用户、删除模板（仅管理员）

#### TC-PERM-003: 管理员角色权限测试
- **测试步骤**:
  1. 以管理员身份登录
  2. 尝试访问所有端点
- **期望结果**:
  - 可以访问所有端点
  - 拥有最高权限

#### TC-PERM-004: 无角色/无效角色测试
- **前置条件**: Token中包含无效的角色信息
- **期望结果**:
  - 所有需要权限的端点返回403

### 6.2 跨角色操作测试

#### TC-PERM-005: 候选人尝试修改面试官创建的题目
- **期望结果**: HTTP 状态码: 403

#### TC-PERM-006: 面试官尝试删除管理员创建的用户
- **期望结果**: HTTP 状态码: 403

#### TC-PERM-007: 候选人A尝试查看候选人B的面试
- **期望结果**: HTTP 状态码: 403

#### TC-PERM-008: 候选人尝试创建面试场次（为其他候选人）
- **期望结果**: 根据业务规则，可能返回403或400

### 6.3 Token 安全测试

#### TC-PERM-009: 使用过期Token访问
- **期望结果**: 所有端点返回401

#### TC-PERM-010: 使用伪造Token访问
- **期望结果**: 所有端点返回401

#### TC-PERM-011: Token中修改用户ID
- **前置条件**: 篡改Token中的userId
- **期望结果**: Token验证失败，返回401

#### TC-PERM-012: Token中修改角色信息
- **前置条件**: 篡改Token中的role
- **期望结果**: Token验证失败，返回401

#### TC-PERM-013: 同时使用多个Token
- **前置条件**: 请求中包含多个Authorization头
- **期望结果**: 返回400或401

---

## 7. 数据验证测试

### 7.1 输入验证测试

#### TC-VALID-001: SQL注入测试
- **测试数据**: 在各个输入字段注入SQL语句
- **示例**: `username: "admin' OR '1'='1"`
- **期望结果**: 
  - 输入被正确转义或拒绝
  - 不会导致SQL注入

#### TC-VALID-002: XSS注入测试
- **测试数据**: 在文本字段注入脚本
- **示例**: `title: "<script>alert('XSS')</script>"`
- **期望结果**: 
  - 输入被正确转义或清理
  - 不会执行脚本

#### TC-VALID-003: 超长字符串测试
- **测试数据**: 提交超长字符串（如10000字符）
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "输入长度超出限制"

#### TC-VALID-004: 特殊字符测试
- **测试数据**: 包含各种特殊字符（如 `!@#$%^&*(){}[]`）
- **期望结果**: 
  - 根据字段要求，合理接受或拒绝
  - 正确存储和返回

#### TC-VALID-005: Unicode字符测试
- **测试数据**: 包含emoji、中文、日文等Unicode字符
- **期望结果**: 
  - 正确处理和存储Unicode字符
  - 返回时字符完整

#### TC-VALID-006: NULL值测试
- **测试数据**: 各个字段提交null值
- **期望结果**: 
  - 必填字段拒绝null，返回400
  - 可选字段正确处理null

#### TC-VALID-007: 空字符串测试
- **测试数据**: 必填字段提交空字符串
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "字段不能为空"

#### TC-VALID-008: 类型不匹配测试
- **测试数据**: 数字字段提交字符串，字符串字段提交数字等
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "字段类型错误"

#### TC-VALID-009: 布尔值测试
- **测试数据**: 布尔字段提交非布尔值（如 "true" 字符串）
- **期望结果**: 
  - 正确转换或拒绝
  - 返回400或正确处理

#### TC-VALID-010: JSON格式验证
- **测试数据**: JSON字段提交无效JSON
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "JSON格式错误"

### 7.2 边界值测试

#### TC-VALID-011: 最小值测试
- **测试数据**: 数字字段提交最小允许值
- **期望结果**: 成功处理

#### TC-VALID-012: 最大值测试
- **测试数据**: 数字字段提交最大允许值
- **期望结果**: 成功处理

#### TC-VALID-013: 负数测试
- **测试数据**: 不应为负的字段（如时间限制）提交负数
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "值必须为正数"

#### TC-VALID-014: 零值测试
- **测试数据**: 各字段提交0
- **期望结果**: 根据业务规则正确处理

#### TC-VALID-015: 浮点数精度测试
- **测试数据**: 分数字段提交高精度小数
- **期望结果**: 正确处理精度，不丢失数据

### 7.3 日期时间验证

#### TC-VALID-016: 无效日期格式
- **测试数据**: `"2025-13-45T25:70:00Z"`
- **期望结果**: 
  - HTTP 状态码: 400
  - 错误消息: "日期格式错误"

#### TC-VALID-017: 过去的日期
- **测试数据**: 面试开始时间为过去的时间
- **期望结果**: 根据业务规则，可能允许或拒绝

#### TC-VALID-018: 遥远未来的日期
- **测试数据**: `"2099-12-31T23:59:59Z"`
- **期望结果**: 根据业务规则处理

#### TC-VALID-019: 时区处理测试
- **测试数据**: 不同时区的时间
- **期望结果**: 正确处理时区转换

---

## 8. 性能与压力测试

### 8.1 性能测试

#### TC-PERF-001: 单个请求响应时间
- **测试步骤**: 测量各个端点的响应时间
- **期望结果**: 
  - 简单查询 < 200ms
  - 复杂查询 < 500ms
  - 代码执行 < 10s

#### TC-PERF-002: 大量数据查询
- **前置条件**: 数据库中有10000+条记录
- **测试步骤**: 查询用户列表、题目列表等
- **期望结果**: 
  - 使用分页
  - 响应时间 < 1s

#### TC-PERF-003: 数据库查询优化
- **测试步骤**: 检查是否使用索引、是否有N+1查询问题
- **期望结果**: 
  - 查询已优化
  - 使用适当的索引

#### TC-PERF-004: 缓存效果测试
- **测试步骤**: 
  1. 首次查询题目列表（冷数据）
  2. 再次查询相同数据（缓存数据）
- **期望结果**: 第二次查询明显更快

### 8.2 并发测试

#### TC-PERF-005: 并发登录测试
- **测试步骤**: 同时50个用户登录
- **期望结果**: 
  - 所有请求成功处理
  - 无超时或错误

#### TC-PERF-006: 并发提交测试
- **测试步骤**: 同一候选人同时提交多个答案
- **期望结果**: 
  - 正确处理并发
  - 无数据冲突

#### TC-PERF-007: 并发创建用户测试
- **测试步骤**: 同时创建多个用户
- **期望结果**: 
  - 无重复用户名或邮箱
  - 事务正确处理

#### TC-PERF-008: 并发更新测试
- **测试步骤**: 多个请求同时更新同一用户
- **期望结果**: 
  - 使用乐观锁或悲观锁
  - 数据一致性保证

### 8.3 压力测试

#### TC-PERF-009: 高并发请求测试
- **测试步骤**: 1000个并发请求
- **期望结果**: 
  - 系统不崩溃
  - 响应时间在可接受范围

#### TC-PERF-010: 长时间运行测试
- **测试步骤**: 持续发送请求24小时
- **期望结果**: 
  - 无内存泄漏
  - 性能稳定

#### TC-PERF-011: 大文件上传测试（如果有）
- **测试数据**: 上传大型代码文件
- **期望结果**: 
  - 正确处理大文件
  - 不影响其他请求

#### TC-PERF-012: 数据库连接池测试
- **测试步骤**: 大量并发请求，观察数据库连接
- **期望结果**: 
  - 连接池正常工作
  - 无连接泄漏

---

## 9. 集成测试场景

### 9.1 完整面试流程测试

#### TC-INTEG-001: 候选人完整面试流程
- **测试步骤**:
  1. 候选人注册并登录
  2. 查看可用的面试场次
  3. 开始面试
  4. 查看题目
  5. 提交编程题答案
  6. 提交问答题答案
  7. 完成面试
  8. 查看结果
- **期望结果**: 整个流程顺畅完成，数据正确

#### TC-INTEG-002: 面试官审核流程
- **测试步骤**:
  1. 面试官登录
  2. 创建题目
  3. 创建面试模板
  4. 创建面试场次
  5. 查看候选人提交
  6. 查看AI评分建议
  7. 调整评分
  8. 生成报告
- **期望结果**: 整个流程顺畅完成

#### TC-INTEG-003: 管理员管理流程
- **测试步骤**:
  1. 管理员登录
  2. 创建用户（各角色）
  3. 管理题库
  4. 管理模板
  5. 查看系统统计
  6. 删除无效数据
- **期望结果**: 所有管理操作成功

### 9.2 异常场景集成测试

#### TC-INTEG-004: 面试中断恢复测试
- **测试步骤**:
  1. 候选人开始面试
  2. 提交部分答案
  3. 断开连接
  4. 重新登录
  5. 继续面试
- **期望结果**: 之前的提交保存，可以继续

#### TC-INTEG-005: 并发面试测试
- **测试步骤**: 一个候选人同时参加多个面试
- **期望结果**: 根据业务规则处理（可能禁止或允许）

#### TC-INTEG-006: 题目更新对进行中面试的影响
- **测试步骤**:
  1. 候选人开始面试
  2. 管理员更新该面试中的题目
  3. 候选人继续答题
- **期望结果**: 不影响进行中的面试（使用原题目版本）

---

## 10. 测试数据准备

### 10.1 基础数据
- **用户数据**:
  - 3个管理员账户
  - 5个面试官账户
  - 20个候选人账户
  
- **题目数据**:
  - 15道编程题（5 easy, 5 medium, 5 hard）
  - 10道问答题（不同难度和标签）

- **模板数据**:
  - 5个不同类型的面试模板
  - 包含不同题目组合

### 10.2 测试用例数据
- 为编程题准备完整的测试用例（正常、边界、异常）
- 为问答题准备参考答案和评分标准

---

## 11. 测试执行计划

### 11.1 测试优先级
1. **P0 - 关键功能**: 认证、提交答案、查看题目
2. **P1 - 核心功能**: 用户管理、题库管理、面试管理
3. **P2 - 辅助功能**: 统计报告、高级筛选
4. **P3 - 性能测试**: 并发、压力测试

### 11.2 测试环境
- **开发环境**: 本地开发测试
- **测试环境**: 独立测试服务器
- **预生产环境**: 模拟生产环境
- **生产环境**: 上线后监控测试

### 11.3 测试工具
- **单元测试**: Jest
- **集成测试**: Supertest + Jest
- **API测试**: Postman/Newman
- **性能测试**: Apache JMeter 或 Artillery
- **自动化测试**: GitHub Actions CI/CD

---

## 12. 测试报告模板

### 测试结果统计
- 总测试用例数: XXX
- 通过数: XXX
- 失败数: XXX
- 阻塞数: XXX
- 通过率: XX%

### 缺陷统计
- 严重缺陷: XX
- 一般缺陷: XX
- 轻微缺陷: XX

### 测试覆盖率
- 代码覆盖率: XX%
- 接口覆盖率: XX%
- 场景覆盖率: XX%

---

## 附录

### A. HTTP 状态码参考
- 200: 成功
- 201: 创建成功
- 204: 删除成功（无内容返回）
- 400: 请求参数错误
- 401: 未授权
- 403: 权限不足
- 404: 资源不存在
- 409: 资源冲突
- 500: 服务器内部错误

### B. 常见错误码定义
建议定义统一的错误码体系，例如：
- AUTH_001: 用户名或密码错误
- AUTH_002: Token过期
- PERM_001: 权限不足
- VALID_001: 参数验证失败
- DB_001: 数据库操作失败

---

**文档版本**: v1.0  
**最后更新**: 2025-10-21  
**维护者**: 测试团队

