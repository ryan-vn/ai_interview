# 项目需求文档 & 技术栈说明  
**项目名称**：AI 面试系统（暂定）  
**参赛者**：XXX（个人／团队）  
**日期**：YYYY-MM-DD  

---

## 一、项目需求文档  

### 1. 引言  
**项目背景**：  
公司组织的 “AI Coding 竞赛” 要求参赛者基于用户故事自定义一个面试系统。该系统旨在模拟技术／行为面试流程，候选人在线答题，系统生成初步评分，面试官复核，生成报告。项目也旨在让参赛者体验人机协作开发流程。  
**目标受众**：  
- 候选人（应聘者或内部晋升者）  
- 面试官／HR  
- 系统管理员／题库管理员  
**文档范围**：  
本需求文档定义系统需实现的功能范围、业务流程、外部接口、非功能需求，以及明确技术栈边界、开发环境约定，以便团队快速启动开发。  
**术语说明**：  
- 候选人：参与面试的用户  
- 面试官：负责审核候选人答题的用户  
- 题库：系统中的题目集合（编程题／问答题）  
- AI 评分：系统利用 AI 模型对候选人提交内容（代码、问答）初步评估得分  

### 2. 范围说明  
**包含范围**：  
- 候选人注册、登录、角色切换（候选人角色）  
- 候选人进入面试场次：选择题目、答题（编程 + 问答）  
- 内置代码编辑器（编程题部分） + 测试执行机制  
- 问答题：文字输入（后可拓展语音）  
- 系统自动执行编程测试用例 + AI 评分模块（代码正确性、性能、结构；问答逻辑、表达）  
- 面试官后台：查看候选人提交、AI评分建议、复核调整得分  
- 报告生成：候选人得分、通过/不通过、建议改进点  
- 题库管理：添加／编辑／删除题目，设置标签、难度、语言  
- 面试场次管理：创建面试、设置题目组合、设置时间限制  
**不包含范围（暂定）**：  
- 视频面试（摄像／实时交互）  
- 多人在线面试（只支持一对一）  
- 高级作弊监控（如摄像头监控、浏览器切换检测）  
- 多语言版本（初期仅中文界面）  
**依赖关系／假设**：  
- 假设系统内部可访问 AI 评分服务（可调用 OpenAI 或本地模型）  
- 假设题库初期容量为 50 题以内，后期可扩展  
- 假设用户使用现代浏览器，支持 ES6+ 、Web Socket 等基础特性  

### 3. 功能需求  
下面按模块列出主要功能及用户故事（高优先顺序为 Must Have）：

#### 3.1 用户角色与认证  
- 功能 F1：用户注册／登录（候选人、面试官、管理员三种角色）  
  - 用户故事：作为候选人，我希望能注册账号并登录系统，以便进入面试流程。  
- 功能 F2：角色权限控制（不同角色访问不同模块）  
  - 面试官／管理员登录后可进入后台管理界面。
- 功能 F3：面试场次创建流程（新增）
  - 用户故事：作为HR，我希望只需要知道候选人的基本信息就可以创建面试场次，系统自动发送邮件邀请。
  - 用户故事：作为候选人，我希望通过邮件邀请链接直接参与面试，无需提前注册。  

#### 3.2 候选人面试流程  
- 功能 F4：候选人选择面试场次／进入面试界面  
  - 用户故事：作为候选人，我希望能看到可参加的面试场次并进入。  
- 功能 F5：候选人通过邀请链接参与面试（新增）
  - 用户故事：作为候选人，我希望通过邮件邀请链接查看面试信息并加入面试。
- 功能 F6：编程题模块：题目展示 + 代码编辑器 + 提交 + 测试执行  
  - 用户故事：作为候选人，我希望在系统中编写代码并提交之后看到运行结果。  
- 功能 F7：问答题模块：文字输入方式（可后续拓展语音） + 提交  
  - 用户故事：作为候选人，我希望回答行为/系统设计题并提交。  
- 功能 F8：自动评分流程：系统对编程题执行测试、分析得分；系统对问答题调用 AI 模型生成初步评分建议  
  - 用户故事：作为候选人，我希望提交后系统可以快速给出反馈。  
- 功能 F9：候选人查看结果界面：得分、报告摘要（初步）  
  - 用户故事：作为候选人，我希望面试结束后能看到我的得分与简要反馈。  

#### 3.3 面试官后台流程  
- 功能 F10：面试官查看候选人提交记录：代码、运行日志、问答内容  
- 功能 F11：面试官查看系统生成的 AI 评分建议，并可手动调整评分  
- 功能 F12：面试官确认最终评分并生成候选人最终报告  
  - 用户故事：作为面试官，我希望快速查看候选人表现并作出判断。  

#### 3.4 管理员与题库管理  
- 功能 F13：管理员／题库管理员登录后台，新增／编辑／删除题目（编程题与问答题）  
- 功能 F14：管理员设定面试模板：题目组合、时间限制、语言选项、难度等级  
- 功能 F15：系统日志及用户管理：查看用户注册／登录情况、角色分配、权限管理  

#### 3.5 报告与统计分析  
- 功能 F16：生成候选人完整面试报告：技术得分、行为得分、综合建议  
- 功能 F17：统计仪表盘（面试官或管理员视角）：今日/本周面试数、平均得分、题目平均得分、通过率  

### 4. 非功能需求  
- 性能：系统在平稳状态下响应时间 ≤ 2 秒；编程题提交后的测试执行反馈 ≤ 10 秒（可根据题量调整）  
- 可用性：支持主流浏览器（Chrome、Edge、Safari），响应式设计适配桌面与平板  
- 可扩展性：系统设计应允许将题库扩展至数千题，支持增加多种语言（如 Python / Java / C#）  
- 可维护性：模块化设计，前后端分离，代码注释规范，便于后续迭代  
- 安全性：使用 HTTPS、JWT 鉴权、角色 RBAC 控制，防止越权、恶意提交代码沙箱隔离  
- 可审计性：提交日志、评分变更日志、用户行为日志均应记录  
- 可测试性：功能模块均应可编写自动化测试（单元测试、集成测试）  

### 5. 技术接口与平台说明  
- 前端与后端采用 API 通信，使用 REST（建议初期）  
- 编程题提交后，后端调用沙箱执行模块，返回执行结果结构（通过数、失败数、日志）  
- 问答题提交后，后端调用 AI 评分服务（可调用 OpenAI/API）返回评分建议与文本反馈  
- 数据库结构（初期简要）：用户表、角色表、题目表、题目类型表、面试场次表、提交记录表、评分记录表  
- 部署环境：容器化部署（Docker），建议开发环境使用本地容器，生产环境可考虑云平台  

### 6. 优先级与里程碑  
- Must Have（优先上线）： F1-F9（用户登录、面试场次创建、候选人流程、编程/问答题、自动评分）  
- Should Have（次优）： F10-F12（面试官后台）  
- Could Have（可后期迭代）： F13-F17（题库管理、统计仪表盘）  

**里程碑示例**：  
- 阶段 1（1‐2 天）：环境搭建、前端 Next.js 骨架、后端 NestJS 骨架、用户登录  
- 阶段 2（2‐3 天）：编程题模块实现（编辑器＋提交＋测试）  
- 阶段 3（1‐2 天）：问答题模块 + AI 评分接口整合  
- 阶段 4（1 天）：面试官后台基础功能  
- 阶段 5（1 天）：报告生成功能、系统测试、演示准备  

---

## 二、技术栈说明  

### 1. 前端技术栈  
- 框架：Next.js（React 生态）  
- 语言：TypeScript  
- 样式：CSS-in-JS（如 styled-components 或 Emotion）或 Tailwind CSS  
- 代码编辑器组件：Monaco Editor 或 Ace Editor  
- 状态管理：React Context ＋ Hooks（视规模可选 Redux/Recoil）  
- 接口调用：Axios 或 Fetch API  
- 路由：Next.js 文件路由机制 + 动态路由  
- UI 组件库：Ant Design 或 MUI  

### 2. 后端技术栈  
- 框架：NestJS  
- 语言：TypeScript  
- HTTP 框架：NestJS 内置 Express（或 Fastify）  
- 数据库：MySQL 或 PostgreSQL；ORM：Prisma 或 TypeORM  
- 缓存：Redis  
- 代码执行沙箱：Docker 或 子进程隔离环境  
- AI 评分服务接口：封装调用 OpenAI/LLM 模型的 REST 接口  
- 鉴权/权限：JWT + RBAC  
- 日志监控：Winston + ELK 或 Prometheus + Grafana  
- 部署：Docker 容器化，CI/CD 流程，区分开发／测试／生产环境  

### 3. 数据模型（简要）  
```sql
User (
  id INT PK,
  username VARCHAR,
  email VARCHAR,
  role_id INT,
  hashed_password VARCHAR,
  created_at DATETIME
);

Role (
  id INT PK,
  name VARCHAR
);

InterviewSession (
  id INT PK,
  name VARCHAR,
  start_time DATETIME,
  end_time DATETIME,
  template_id INT,
  status VARCHAR
);

Template (
  id INT PK,
  name VARCHAR,
  instructions TEXT,
  question_ids JSON,
  time_limit INT
);

Question (
  id INT PK,
  type ENUM('programming','qa'),
  title VARCHAR,
  description TEXT,
  tags JSON,
  difficulty INT,
  language_options JSON
);

Submission (
  id INT PK,
  user_id INT,
  session_id INT,
  question_id INT,
  type ENUM('programming','qa'),
  content TEXT,
  result JSON,
  score FLOAT,
  submitted_at DATETIME
);

ScoreRecord (
  id INT PK,
  submission_id INT,
  ai_score FLOAT,
  human_score FLOAT,
  final_score FLOAT,
  remarks TEXT
);
