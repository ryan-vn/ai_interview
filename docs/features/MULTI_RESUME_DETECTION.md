# å¤šç®€å†æ£€æµ‹ä¸æ‹†åˆ†åŠŸèƒ½

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

å½“ä¸€ä¸ªæ–‡ä»¶ä¸­åŒ…å«å¤šä¸ªäººçš„ç®€å†æ—¶ï¼Œç³»ç»Ÿå¯ä»¥è‡ªåŠ¨è¯†åˆ«å¹¶æ‹†åˆ†æˆå¤šæ¡ç‹¬ç«‹çš„ç®€å†è®°å½•ã€‚è¿™åœ¨ä»¥ä¸‹åœºæ™¯ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼š

- ğŸ“¦ æ‰¹é‡ç®€å†æ‰“åŒ…æ–‡ä»¶
- ğŸª æ‹›è˜ä¼šç°åœºæ”¶é›†çš„åˆå¹¶ç®€å†  
- ğŸ“Š ä»æ‹›è˜å¹³å°å¯¼å‡ºçš„åˆå¹¶æ–‡ä»¶
- ğŸ“„ å›¢é˜Ÿæˆå‘˜ç»Ÿä¸€æäº¤çš„ç®€å†æ–‡æ¡£

## ğŸš€ åŠŸèƒ½ç‰¹ç‚¹

### 1. æ™ºèƒ½æ£€æµ‹

- âœ… è‡ªåŠ¨è¯†åˆ«æ–‡ä»¶ä¸­åŒ…å«çš„ç®€å†æ•°é‡
- âœ… åŒºåˆ†åŒä¸€äººçš„å¤šæ®µç»å†å’Œä¸åŒäººçš„ç®€å†
- âœ… åŸºäºå§“åã€è”ç³»æ–¹å¼ç­‰å…³é”®ä¿¡æ¯åˆ¤æ–­
- âœ… AI é©±åŠ¨ï¼Œå‡†ç¡®ç‡é«˜

### 2. è‡ªåŠ¨æ‹†åˆ†

- âœ… å°†å¤šä¸ªç®€å†æ‹†åˆ†ä¸ºç‹¬ç«‹çš„è®°å½•
- âœ… æ¯ä»½ç®€å†å•ç‹¬è§£æå’Œå­˜å‚¨
- âœ… è‡ªåŠ¨å»é‡ï¼ˆåŸºäºæ‰‹æœºå·ï¼‰
- âœ… å…±äº«åŸå§‹æ–‡ä»¶å¼•ç”¨

### 3. çµæ´»æ§åˆ¶

- âœ… å¯é€‰å¯ç”¨/ç¦ç”¨å¤šç®€å†æ£€æµ‹
- âœ… é»˜è®¤å…³é—­ï¼ŒæŒ‰éœ€å¼€å¯
- âœ… API å‚æ•°æ§åˆ¶
- âœ… å¤±è´¥è‡ªåŠ¨é™çº§åˆ°å•ç®€å†å¤„ç†

## ğŸ”§ æŠ€æœ¯å®ç°

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æ–‡ä»¶ä¸Šä¼                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  POST /resumes/upload                                     â”‚
â”‚  - file: resume.pdf                                       â”‚
â”‚  - detectMultiple: true  â† å¯ç”¨å¤šç®€å†æ£€æµ‹                â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. AI æ£€æµ‹ç®€å†æ•°é‡                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  detectMultipleResumesInText()                            â”‚
â”‚  - æå–æ–‡ä»¶æ–‡æœ¬                                           â”‚
â”‚  - AI åˆ†æåŒ…å«å‡ ä»½ç®€å†                                    â”‚
â”‚  - è¿”å›: { isMultiple: true, count: 3 }                  â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. å•ä¸ª or å¤šä¸ªï¼Ÿ                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  if (count <= 1)                                          â”‚
â”‚    â†’ æŒ‰å•ä¸ªç®€å†å¤„ç†                                       â”‚
â”‚  else                                                     â”‚
â”‚    â†’ æ‹†åˆ†è§£æå¤šä¸ªç®€å†                                     â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. æ‹†åˆ†å¹¶è§£æï¼ˆå¤šç®€å†æƒ…å†µï¼‰                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  parseMultipleResumesFromText()                           â”‚
â”‚  - AI æ‹†åˆ†æ¯ä»½ç®€å†çš„å†…å®¹                                  â”‚
â”‚  - åˆ†åˆ«æå–æ¯ä»½ç®€å†çš„ä¿¡æ¯                                 â”‚
â”‚  - è¿”å›: ParsedResume[]                                   â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. åˆ›å»ºå¤šæ¡è®°å½•                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  handleMultipleResumes()                                  â”‚
â”‚  - ç¬¬1ä¸ªï¼šæ›´æ–°åŸè®°å½•                                      â”‚
â”‚  - ç¬¬2-Nä¸ªï¼šåˆ›å»ºæ–°è®°å½•                                    â”‚
â”‚  - æ£€æŸ¥æ‰‹æœºå·å»é‡                                         â”‚
â”‚  - è®°å½•å®¡è®¡æ—¥å¿—                                           â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒä»£ç 

#### 1. AI æ£€æµ‹

```typescript
/**
 * ä½¿ç”¨ AI æ£€æµ‹æ–‡æœ¬ä¸­æ˜¯å¦åŒ…å«å¤šä¸ªç®€å†
 */
async detectMultipleResumesInText(text: string): Promise<{
  isMultiple: boolean;
  count: number;
}> {
  const completion = await this.openai.chat.completions.create({
    model: 'deepseek-chat',
    messages: [
      {
        role: 'system',
        content: `ä½ æ˜¯ä¸€ä¸ªç®€å†è¯†åˆ«ä¸“å®¶ã€‚è¯·åˆ¤æ–­æä¾›çš„æ–‡æœ¬ä¸­åŒ…å«å¤šå°‘ä»½ç®€å†ã€‚

åˆ¤æ–­æ ‡å‡†ï¼š
1. æ¯ä»½ç®€å†é€šå¸¸åŒ…å«ï¼šå§“åã€è”ç³»æ–¹å¼ã€å·¥ä½œç»å†ã€æ•™è‚²èƒŒæ™¯
2. å¦‚æœæœ‰å¤šä¸ªä¸åŒçš„å§“åå’Œè”ç³»æ–¹å¼ï¼Œå¯èƒ½æ˜¯å¤šä»½ç®€å†
3. æ³¨æ„åŒºåˆ†åŒä¸€äººçš„å¤šæ¬¡å·¥ä½œç»å†å’Œä¸åŒäººçš„ç®€å†

è¿”å› JSON æ ¼å¼ï¼š
{
  "isMultiple": true/false,
  "count": ç®€å†æ•°é‡,
  "reason": "åˆ¤æ–­ç†ç”±"
}`,
      },
      {
        role: 'user',
        content: `è¯·åˆ†æä»¥ä¸‹æ–‡æœ¬åŒ…å«å¤šå°‘ä»½ç®€å†ï¼š\n\n${text}`,
      },
    ],
    temperature: 0.2,
    response_format: { type: 'json_object' },
  });

  return JSON.parse(completion.choices[0].message.content);
}
```

#### 2. AI æ‹†åˆ†

```typescript
/**
 * ä»æ–‡æœ¬ä¸­è§£æå¤šä¸ªç®€å†
 */
async parseMultipleResumesFromText(text: string): Promise<ParsedResume[]> {
  const completion = await this.openai.chat.completions.create({
    model: 'deepseek-chat',
    messages: [
      {
        role: 'system',
        content: `ä½ æ˜¯ä¸“ä¸šçš„ç®€å†è§£æåŠ©æ‰‹ã€‚æ–‡æœ¬ä¸­åŒ…å«å¤šä»½ç®€å†ï¼Œè¯·å°†æ¯ä»½ç®€å†åˆ†åˆ«æå–å‡ºæ¥ã€‚

è¿”å› JSON æ ¼å¼ï¼š
{
  "resumes": [
    {
      "name": "å§“å",
      "phone": "æ‰‹æœºå·",
      "email": "é‚®ç®±",
      "skills": ["æŠ€èƒ½1", "æŠ€èƒ½2"],
      "experience": [...],
      "education": [...]
    }
  ]
}`,
      },
      {
        role: 'user',
        content: `è¯·è§£æä»¥ä¸‹å¤šä»½ç®€å†ï¼š\n\n${text}`,
      },
    ],
    temperature: 0.2,
    response_format: { type: 'json_object' },
  });

  const parsed = JSON.parse(completion.choices[0].message.content);
  return parsed.resumes;
}
```

#### 3. åˆ›å»ºå¤šæ¡è®°å½•

```typescript
/**
 * å¤„ç†ä¸€ä¸ªæ–‡ä»¶ä¸­çš„å¤šä¸ªç®€å†
 */
async handleMultipleResumes(
  originalResumeId: number,
  parsedResumes: ParsedResume[],
  filePath: string,
  jobId?: number,
  userId?: number,
): Promise<void> {
  for (let i = 0; i < parsedResumes.length; i++) {
    const parsed = parsedResumes[i];
    
    // æ£€æŸ¥æ‰‹æœºå·æ˜¯å¦é‡å¤
    if (parsed.phone) {
      const existing = await this.resumesRepository.findOne({
        where: { phone: parsed.phone, isDeleted: false },
      });
      
      if (existing) {
        console.log(`è·³è¿‡é‡å¤ç®€å†: ${parsed.name}`);
        continue;
      }
    }
    
    // ç¬¬ä¸€ä¸ªæ›´æ–°åŸè®°å½•ï¼Œå…¶ä»–åˆ›å»ºæ–°è®°å½•
    let resume: Resume;
    if (i === 0) {
      resume = await this.updateFirstResume(originalResumeId, parsed);
    } else {
      resume = await this.createNewResume(parsed, filePath, jobId, userId);
    }
    
    console.log(`åˆ›å»ºç®€å† ${i + 1}/${parsedResumes.length}: ${parsed.name}`);
  }
}
```

## ğŸ“ ä½¿ç”¨æ–¹æ³•

### API è°ƒç”¨

#### åŸºæœ¬ç”¨æ³•

```bash
# å¯ç”¨å¤šç®€å†æ£€æµ‹
curl -X POST "http://localhost:3001/resumes/upload" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "file=@multi_resumes.pdf" \
  -F "detectMultiple=true"
```

#### å…³è”å²—ä½

```bash
# å¯ç”¨å¤šç®€å†æ£€æµ‹ + å…³è”å²—ä½
curl -X POST "http://localhost:3001/resumes/upload" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "file=@multi_resumes.pdf" \
  -F "detectMultiple=true" \
  -F "jobId=1"
```

#### é»˜è®¤è¡Œä¸ºï¼ˆä¸æ£€æµ‹ï¼‰

```bash
# é»˜è®¤æŒ‰å•ä¸ªç®€å†å¤„ç†
curl -X POST "http://localhost:3001/resumes/upload" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "file=@resume.pdf"
```

### å‰ç«¯é›†æˆ

```typescript
// æ·»åŠ å¤šç®€å†æ£€æµ‹é€‰é¡¹
const [enableMultiDetection, setEnableMultiDetection] = useState(false);

const handleFileUpload = async (file: File) => {
  const formData = new FormData();
  formData.append('file', file);
  formData.append('detectMultiple', enableMultiDetection ? 'true' : 'false');
  
  const response = await api.post('/resumes/upload', formData);
  
  if (response.data.parseStatus === 'success') {
    alert('ç®€å†ä¸Šä¼ æˆåŠŸï¼ç³»ç»Ÿæ­£åœ¨è§£æ...');
  }
};

// UI ç»„ä»¶
<div>
  <input 
    type="file" 
    accept=".pdf,.docx,.txt"
    onChange={(e) => {
      const file = e.target.files?.[0];
      if (file) handleFileUpload(file);
    }}
  />
  
  <label>
    <input 
      type="checkbox"
      checked={enableMultiDetection}
      onChange={(e) => setEnableMultiDetection(e.target.checked)}
    />
    æ£€æµ‹å¹¶æ‹†åˆ†å¤šä¸ªç®€å†
  </label>
</div>
```

## ğŸ¯ å…¸å‹åœºæ™¯

### åœºæ™¯ 1: æ‹›è˜ä¼šç°åœºåˆå¹¶ç®€å†

**æƒ…å†µ**:
- æ‹›è˜ä¼šæ”¶é›†äº† 10 ä»½çº¸è´¨ç®€å†
- æ‰«ææˆä¸€ä¸ª PDF æ–‡ä»¶
- éœ€è¦æ‰¹é‡å½•å…¥ç³»ç»Ÿ

**è§£å†³æ–¹æ¡ˆ**:
```bash
curl -X POST "http://localhost:3001/resumes/upload" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "file=@job_fair_resumes.pdf" \
  -F "detectMultiple=true" \
  -F "jobId=5"
```

**ç»“æœ**:
- âœ… è‡ªåŠ¨è¯†åˆ« 10 ä»½ç®€å†
- âœ… æ‹†åˆ†æˆ 10 æ¡è®°å½•
- âœ… å…¨éƒ¨å…³è”åˆ°å²—ä½ 5
- âœ… è‡ªåŠ¨å»é‡ï¼ˆå¦‚æœ‰é‡å¤ï¼‰

### åœºæ™¯ 2: é‚®ä»¶é™„ä»¶åˆå¹¶ç®€å†

**æƒ…å†µ**:
- æ”¶åˆ°ä¸€å°é‚®ä»¶
- é™„ä»¶åŒ…å« 3 ä¸ªåº”è˜è€…çš„ç®€å†ï¼ˆWord æ ¼å¼ï¼‰
- ä¸‰äººåº”è˜åŒä¸€å²—ä½

**æ“ä½œ**:
1. ä¿å­˜é™„ä»¶ä¸º DOCX
2. ä¸Šä¼ å¹¶å¯ç”¨å¤šç®€å†æ£€æµ‹
3. ç³»ç»Ÿè‡ªåŠ¨åˆ›å»º 3 æ¡è®°å½•

### åœºæ™¯ 3: æ‰¹é‡å¯¼å…¥å†å²ç®€å†

**æƒ…å†µ**:
- æœ‰ä¸€ä¸ªåŒ…å«å¤šä¸ªç®€å†çš„æ—§æ–‡ä»¶
- éœ€è¦è¿ç§»åˆ°æ–°ç³»ç»Ÿ

**æ“ä½œ**:
```bash
# æ‰¹é‡å¤„ç†å¤šä¸ªæ–‡ä»¶
for file in *.pdf; do
  curl -X POST "http://localhost:3001/resumes/upload" \
    -H "Authorization: Bearer YOUR_TOKEN" \
    -F "file=@$file" \
    -F "detectMultiple=true"
done
```

## ğŸ’¡ å·¥ä½œåŸç†

### åˆ¤æ–­æ ‡å‡†

AI æ ¹æ®ä»¥ä¸‹ç‰¹å¾åˆ¤æ–­æ˜¯å¦ä¸ºå¤šä»½ç®€å†ï¼š

#### å¼ºç‰¹å¾ï¼ˆé«˜æƒé‡ï¼‰
- âœ… å‡ºç°å¤šä¸ªä¸åŒçš„å§“å
- âœ… å‡ºç°å¤šä¸ªä¸åŒçš„æ‰‹æœºå·
- âœ… å‡ºç°å¤šä¸ªä¸åŒçš„é‚®ç®±åœ°å€
- âœ… æ˜æ˜¾çš„ç®€å†åˆ†éš”æ ‡è®°ï¼ˆé¡µç ã€åˆ†å‰²çº¿ç­‰ï¼‰

#### å¼±ç‰¹å¾ï¼ˆä½æƒé‡ï¼‰
- âš ï¸ å¤šä¸ªæ•™è‚²èƒŒæ™¯ï¼ˆå¯èƒ½æ˜¯åŒä¸€äººï¼‰
- âš ï¸ å¤šä¸ªå·¥ä½œç»å†ï¼ˆå¯èƒ½æ˜¯åŒä¸€äººï¼‰
- âš ï¸ ä¸åŒçš„ä¸“ä¸šæŠ€èƒ½åˆ—è¡¨

#### æ’é™¤æƒ…å†µ
- âŒ åŒä¸€äººçš„å±¥å†æ›´æ–°ç‰ˆæœ¬
- âŒ åŒè¯­ç®€å†ï¼ˆä¸­è‹±æ–‡ï¼‰
- âŒ é™„ä»¶ææ–™ï¼ˆæ¨èä¿¡ã€ä½œå“é›†ç­‰ï¼‰

### å¤„ç†æµç¨‹

```
1. æ–‡æœ¬æå–
   â””â”€â†’ ä½¿ç”¨ pdf-parse / mammoth æå–çº¯æ–‡æœ¬
   
2. AI åˆæ­¥æ£€æµ‹
   â””â”€â†’ å¿«é€Ÿåˆ¤æ–­ï¼šå•ä¸ª or å¤šä¸ª
   
3. å¦‚æœæ˜¯å¤šä¸ª
   â”œâ”€â†’ AI æ‹†åˆ†å†…å®¹
   â”œâ”€â†’ åˆ†åˆ«è§£ææ¯ä»½ç®€å†
   â””â”€â†’ éªŒè¯å’Œå»é‡
   
4. åˆ›å»ºè®°å½•
   â”œâ”€â†’ ç¬¬1ä»½ï¼šæ›´æ–°åŸè®°å½•
   â””â”€â†’ ç¬¬2-Nä»½ï¼šåˆ›å»ºæ–°è®°å½•
   
5. å®¡è®¡æ—¥å¿—
   â””â”€â†’ è®°å½•å¤šç®€å†æ‹†åˆ†æ“ä½œ
```

## âš™ï¸ é…ç½®é€‰é¡¹

### å¯ç”¨æ¡ä»¶

å¤šç®€å†æ£€æµ‹åœ¨ä»¥ä¸‹æƒ…å†µä¸‹å¯ç”¨ï¼š

```typescript
// API å‚æ•°
detectMultiple: true | 'true' | '1'

// é»˜è®¤å€¼
detectMultiple: false  // ä¸ºäº†å‘åå…¼å®¹å’Œæ€§èƒ½è€ƒè™‘
```

### æ€§èƒ½å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| æœ€å¤§ç®€å†æ•° | å•ä¸ªæ–‡ä»¶æœ€å¤šæ‹†åˆ†æ•° | 20 |
| è¶…æ—¶æ—¶é—´ | AI æ£€æµ‹è¶…æ—¶ | 30ç§’ |
| æ–‡æœ¬é•¿åº¦é™åˆ¶ | æ£€æµ‹æ—¶åªåˆ†æå‰Nå­—ç¬¦ | 4000 |

## ğŸ“Š æ€§èƒ½è€ƒè™‘

### å¤„ç†æ—¶é—´

| ç®€å†æ•°é‡ | æ£€æµ‹æ—¶é—´ | è§£ææ—¶é—´ | æ€»æ—¶é—´ |
|---------|---------|---------|--------|
| 1ä»½ | è·³è¿‡ | ~2s | ~2s |
| 2-3ä»½ | ~2s | ~4-6s | ~6-8s |
| 4-5ä»½ | ~2s | ~8-12s | ~10-14s |
| 6-10ä»½ | ~3s | ~15-25s | ~18-28s |

### API è°ƒç”¨æˆæœ¬

- **æ£€æµ‹é˜¶æ®µ**: 1æ¬¡ API è°ƒç”¨ï¼ˆæ£€æµ‹æ•°é‡ï¼‰
- **è§£æé˜¶æ®µ**: 1æ¬¡ API è°ƒç”¨ï¼ˆæ‹†åˆ†å¹¶è§£ææ‰€æœ‰ç®€å†ï¼‰
- **æ€»è®¡**: 2æ¬¡ API è°ƒç”¨ï¼ˆæ— è®ºå¤šå°‘ä»½ç®€å†ï¼‰

### ä¼˜åŒ–å»ºè®®

1. **æŒ‰éœ€å¯ç”¨**
   - åªåœ¨ç¡®å®šå¯èƒ½æœ‰å¤šä»½ç®€å†æ—¶å¯ç”¨
   - é»˜è®¤å…³é—­ä»¥æé«˜æ€§èƒ½

2. **å¼‚æ­¥å¤„ç†**
   - æ£€æµ‹å’Œæ‹†åˆ†åœ¨åå°å¼‚æ­¥å®Œæˆ
   - ç”¨æˆ·ç«‹å³å¾—åˆ°å“åº”

3. **æ‰¹é‡ä¸Šä¼ **
   - æ‰¹é‡ä¸Šä¼ æ—¶å»ºè®®å…³é—­å¤šç®€å†æ£€æµ‹
   - æ¯ä¸ªæ–‡ä»¶å•ç‹¬å¤„ç†ä¼šæ›´å¯æ§

## ğŸ› å¼‚å¸¸å¤„ç†

### 1. æ£€æµ‹å¤±è´¥

**æƒ…å†µ**: AI æ£€æµ‹ç®€å†æ•°é‡å¤±è´¥

**å¤„ç†**: è‡ªåŠ¨é™çº§åˆ°å•ç®€å†å¤„ç†
```
[LOG] AI æ£€æµ‹ç®€å†æ•°é‡å¤±è´¥: timeout
[LOG] å°è¯•æŒ‰å•ä¸ªç®€å†å¤„ç†...
[LOG] ç®€å†è§£ææˆåŠŸ: å¼ ä¸‰
```

### 2. æ‹†åˆ†å¤±è´¥

**æƒ…å†µ**: AI æ— æ³•æ­£ç¡®æ‹†åˆ†å¤šä»½ç®€å†

**å¤„ç†**: è¿”å›é”™è¯¯ï¼Œä¿ç•™åŸæ–‡ä»¶
```
[ERROR] è§£æå¤šä»½ç®€å†å¤±è´¥: æ— æ³•è¯†åˆ«ç®€å†è¾¹ç•Œ
[LOG] æ–‡ä»¶å·²ä¿å­˜: /uploads/resumes/xxx.pdf
[æç¤º] è¯·æ‰‹åŠ¨æ‹†åˆ†æ–‡ä»¶åé‡æ–°ä¸Šä¼ 
```

### 3. éƒ¨åˆ†å¤±è´¥

**æƒ…å†µ**: 10ä»½ç®€å†ä¸­ï¼Œ2ä»½è§£æå¤±è´¥

**å¤„ç†**: æˆåŠŸçš„è®°å½•å·²åˆ›å»ºï¼Œå¤±è´¥çš„è·³è¿‡
```
[LOG] åˆ›å»ºç®€å† 1/10: å¼ ä¸‰ âœ…
[LOG] åˆ›å»ºç®€å† 2/10: æå›› âœ…
[ERROR] åˆ›å»ºç®€å† 3/10 å¤±è´¥: ç¼ºå°‘å¿…å¡«å­—æ®µ âŒ
...
[LOG] å¤šç®€å†å¤„ç†å®Œæˆ: æˆåŠŸ 8/10
```

### 4. å…¨éƒ¨é‡å¤

**æƒ…å†µ**: æ‰€æœ‰ç®€å†çš„æ‰‹æœºå·éƒ½å·²å­˜åœ¨

**å¤„ç†**: å…¨éƒ¨è·³è¿‡ï¼Œä¸åˆ›å»ºæ–°è®°å½•
```
[LOG] è·³è¿‡é‡å¤ç®€å†: å¼ ä¸‰ (æ‰‹æœºå·å·²å­˜åœ¨)
[LOG] è·³è¿‡é‡å¤ç®€å†: æå›› (æ‰‹æœºå·å·²å­˜åœ¨)
...
[LOG] å¤šç®€å†å¤„ç†å®Œæˆ: æˆåŠŸ 0/5ï¼ˆå…¨éƒ¨é‡å¤ï¼‰
```

## ğŸ“ˆ ç»Ÿè®¡å’Œç›‘æ§

### å®¡è®¡æ—¥å¿—

æ¯æ¬¡å¤šç®€å†å¤„ç†éƒ½ä¼šè®°å½•è¯¦ç»†æ—¥å¿—ï¼š

```json
{
  "resumeId": 123,
  "action": "PARSE",
  "userId": 1,
  "details": {
    "multiResumeIndex": 2,
    "totalCount": 5,
    "name": "æå››"
  },
  "createdAt": "2024-10-25T10:30:00Z"
}
```

### æŸ¥è¯¢ç»Ÿè®¡

```sql
-- æŸ¥è¯¢å¤šç®€å†å¤„ç†è®°å½•
SELECT 
  r.id,
  r.name,
  r.fileName,
  a.details->>'$.totalCount' as total_count,
  a.details->>'$.multiResumeIndex' as resume_index
FROM resumes r
JOIN resume_audit_logs a ON a.resume_id = r.id
WHERE a.details->>'$.totalCount' IS NOT NULL
ORDER BY a.created_at DESC;
```

## âœ… æµ‹è¯•å»ºè®®

### å•å…ƒæµ‹è¯•

```typescript
describe('Multiple Resume Detection', () => {
  it('should detect single resume', async () => {
    const result = await aiService.detectAndParseMultipleResumes('single.pdf');
    expect(result.isMultiple).toBe(false);
    expect(result.count).toBe(1);
  });

  it('should detect multiple resumes', async () => {
    const result = await aiService.detectAndParseMultipleResumes('multi.pdf');
    expect(result.isMultiple).toBe(true);
    expect(result.count).toBeGreaterThan(1);
  });

  it('should split and parse multiple resumes', async () => {
    const result = await aiService.detectAndParseMultipleResumes('three_resumes.pdf');
    expect(result.resumes).toHaveLength(3);
    expect(result.resumes[0].name).toBeDefined();
    expect(result.resumes[1].name).toBeDefined();
    expect(result.resumes[2].name).toBeDefined();
  });
});
```

### é›†æˆæµ‹è¯•

```typescript
describe('Resume Upload with Multi-Detection', () => {
  it('should create multiple records from one file', async () => {
    const response = await request(app.getHttpServer())
      .post('/resumes/upload')
      .attach('file', 'test/fixtures/multi_resumes.pdf')
      .field('detectMultiple', 'true')
      .expect(201);

    // éªŒè¯åˆ›å»ºäº†å¤šæ¡è®°å½•
    const resumes = await resumeRepository.find({
      where: { filePath: response.body.filePath }
    });
    
    expect(resumes.length).toBeGreaterThan(1);
  });
});
```

## ğŸ”® æœªæ¥æ”¹è¿›

### çŸ­æœŸ (1-2å‘¨)
- [ ] æ·»åŠ è¿›åº¦æç¤ºï¼ˆæ­£åœ¨å¤„ç†ç¬¬ X/N ä»½ç®€å†ï¼‰
- [ ] æ”¯æŒè‡ªå®šä¹‰æœ€å¤§ç®€å†æ•°é™åˆ¶
- [ ] ä¼˜åŒ– AI æç¤ºè¯ä»¥æé«˜å‡†ç¡®ç‡

### ä¸­æœŸ (1-2æœˆ)
- [ ] å‰ç«¯æ˜¾ç¤ºå¤šç®€å†æ‹†åˆ†ç»“æœ
- [ ] æ”¯æŒæ‰‹åŠ¨è°ƒæ•´æ‹†åˆ†ç»“æœ
- [ ] æ·»åŠ ç®€å†åˆå¹¶åŠŸèƒ½ï¼ˆåå‘æ“ä½œï¼‰

### é•¿æœŸ (3-6æœˆ)
- [ ] æœºå™¨å­¦ä¹ æ¨¡å‹ä¼˜åŒ–æ£€æµ‹
- [ ] æ”¯æŒæ›´å¤æ‚çš„æ–‡æ¡£ç»“æ„
- [ ] æ‰¹é‡å¤„ç†æ€§èƒ½ä¼˜åŒ–

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [AI ç®€å†è§£æ](./AI_RESUME_PARSING.md)
- [DOCX æ ¼å¼æ”¯æŒ](./DOCX_SUPPORT_UPGRADE.md)
- [ç®€å†ç®¡ç†åŠŸèƒ½](./RESUME_QUICK_START.md)
- [API æ–‡æ¡£](../api/RESUME_API.md)

## ğŸ‰ æ€»ç»“

å¤šç®€å†æ£€æµ‹ä¸æ‹†åˆ†åŠŸèƒ½å¤§å¹…æå‡äº†æ‰¹é‡ç®€å†å¤„ç†æ•ˆç‡ï¼š

- âœ… è‡ªåŠ¨è¯†åˆ«ï¼šæ— éœ€æ‰‹åŠ¨æ‹†åˆ†æ–‡ä»¶
- âœ… æ™ºèƒ½å¤„ç†ï¼šAI å‡†ç¡®æ‹†åˆ†å’Œè§£æ
- âœ… çµæ´»æ§åˆ¶ï¼šå¯é€‰å¯ç”¨ï¼ŒæŒ‰éœ€ä½¿ç”¨
- âœ… å¥å£®æ€§å¼ºï¼šå¤±è´¥è‡ªåŠ¨é™çº§
- âœ… å®Œæ•´å®¡è®¡ï¼šå…¨ç¨‹æ—¥å¿—è®°å½•

**é€‚ç”¨åœºæ™¯**: æ‹›è˜ä¼šã€æ‰¹é‡å¯¼å…¥ã€åˆå¹¶æ–‡æ¡£å¤„ç†
**å»ºè®®**: åœ¨ç¡®å®šæ–‡ä»¶åŒ…å«å¤šä»½ç®€å†æ—¶å¯ç”¨æ­¤åŠŸèƒ½

